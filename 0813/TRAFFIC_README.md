# 交通資訊爬蟲程式

這個程式會讀取之前生成的設施 JSON 檔案，逐一搜尋每個設施的詳細交通資訊，並根據你設定的條件進行篩選。

## 🚀 功能特色

- 讀取設施 JSON 檔案
- 逐一搜尋每個設施的路線資訊
- 自動點擊「按距離排序」
- 獲取所有交通方式的時間（開車、大眾運輸、步行、騎車）
- 可自訂篩選條件（例如：大眾運輸超過15分鐘就刪除）
- 將完整交通資訊儲存到新的 JSON 檔案

## 📁 檔案說明

1. **`traffic_info_crawler.py`** - 主要爬蟲程式
2. **`run_traffic_crawler.py`** - 執行腳本（推薦使用）
3. **`traffic_config.json`** - 配置文件（可自訂篩選條件）

## ⚙️ 設定篩選條件

編輯 `traffic_config.json` 檔案中的篩選條件：

```json
{
  "篩選條件": {
    "大眾運輸篩選": {
      "啟用": true,
      "交通方式": "大眾運輸",
      "最大時間_分鐘": 15,
      "說明": "大眾運輸超過15分鐘就刪除該設施"
    },
    "開車篩選": {
      "啟用": false,
      "交通方式": "開車",
      "最大時間_分鐘": 30,
      "說明": "開車超過30分鐘就刪除該設施"
    }
  }
}
```

### 篩選條件設定說明：

- **啟用**: `true` 啟用此篩選條件，`false` 停用
- **交通方式**: 可選擇 "開車"、"大眾運輸"、"步行"、"騎車"
- **最大時間_分鐘**: 超過此時間的設施會被刪除
- **說明**: 篩選條件的說明文字

## 🚀 執行方式

### 方式一：使用配置文件執行（推薦）
```bash
python run_traffic_crawler.py
```

### 方式二：直接執行主程式
```bash
python traffic_info_crawler.py
```

## 📋 輸入檔案格式

程式會讀取之前生成的設施 JSON 檔案，例如 `nearby_車站.json`：

```json
[
  {
    "設施名稱": "台中車站",
    "地址": "台中市中區台灣大道一段1號",
    "設施資訊": "火車站 · 4.2 顆星 · 營業中",
    "設施類型": "車站",
    "搜尋地址": "臺中市北區三民路三段"
  }
]
```

## 📋 輸出檔案格式

程式會生成包含完整交通資訊的 JSON 檔案：

```json
[
  {
    "設施名稱": "台中車站",
    "地址": "台中市中區台灣大道一段1號",
    "設施資訊": "火車站 · 4.2 顆星 · 營業中",
    "設施類型": "車站",
    "搜尋地址": "臺中市北區三民路三段",
    "交通資訊": {
      "開車": "12分鐘",
      "大眾運輸": "25分鐘",
      "步行": "1小時15分鐘",
      "騎車": "18分鐘"
    }
  }
]
```

## 🔧 自訂設定

### 修改輸入/輸出檔案
在 `traffic_config.json` 中修改：
```json
{
  "檔案設定": {
    "輸入檔案": "your_input_file.json",
    "輸出檔案": "your_output_file.json"
  }
}
```

### 修改起始地址
```json
{
  "搜尋設定": {
    "起始地址": "你的起始地址"
  }
}
```

### 添加新的篩選條件
```json
{
  "篩選條件": {
    "新篩選條件": {
      "啟用": true,
      "交通方式": "步行",
      "最大時間_分鐘": 60,
      "說明": "步行超過1小時就刪除"
    }
  }
}
```

## ⚠️ 注意事項

1. **執行時間**: 每個設施需要約10-15秒處理時間，請耐心等待
2. **網路連線**: 確保網路連線穩定
3. **Google Maps 變化**: 如果頁面結構改變，可能需要更新選擇器
4. **篩選邏輯**: 只有符合所有啟用篩選條件的設施才會被保留

## 🔄 執行流程

1. 載入設施 JSON 檔案
2. 對每個設施執行以下步驟：
   - 在 Google Maps 搜尋路線
   - 點擊「按距離排序」
   - 切換不同交通方式並記錄時間
   - 應用篩選條件
3. 儲存通過篩選的設施到新的 JSON 檔案

## 🛠️ 故障排除

### Q: 找不到輸入檔案
A: 確認 `nearby_車站.json` 檔案存在，或修改配置文件中的檔案路徑

### Q: 無法找到路線按鈕
A: Google Maps 介面可能有變化，程式會自動嘗試多種選擇器

### Q: 篩選條件沒有生效
A: 檢查配置文件中的 `啟用` 是否設為 `true`

### Q: 程式執行很慢
A: 這是正常現象，因為需要等待每個路線的計算和頁面載入